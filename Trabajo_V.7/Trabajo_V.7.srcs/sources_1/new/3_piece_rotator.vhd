library ieee;
use ieee.std_logic_1164.all;

entity piece_rom is
    port (
        piece_id  : in integer;
        rotation  : in integer;
        shape_16b : out std_logic_vector(15 downto 0)
    );
end entity;


architecture DATAFLOW of piece_rom is

    -- Definición de los 7 tetrominós × 4 rotaciones
    -- Cada pieza es un vector de 4 rotaciones, cada una con 16 bits
    type rot_array_t is array (0 to 3) of std_logic_vector(15 downto 0);
    type piece_array_t is array (0 to 6) of rot_array_t;

    constant TETROMINOS : piece_array_t := (

    -------------------------------------------------------------------------
    -- 0) PIEZA I
    -------------------------------------------------------------------------
        0 => (
            -- Rot 0: horizontal
            "0000111100000000",
            -- Rot 1: vertical
            "0010001000100010",
            -- Rot 2 = Rot 0
            "0000111100000000",
            -- Rot 3 = Rot 1
            "0010001000100010"
        ),

    -------------------------------------------------------------------------
    -- 1) PIEZA O
    -------------------------------------------------------------------------
        1 => (
            -- Rotaciones idénticas
            "0110011000000000",
            "0110011000000000",
            "0110011000000000",
            "0110011000000000"
        ),

    -------------------------------------------------------------------------
    -- 2) PIEZA T
    -------------------------------------------------------------------------
        2 => (
            "0000111001000000", -- 0
            "0100011001000000", -- 1
            "0100111000000000", -- 2
            "0100110001000000"  -- 3
        ),

    -------------------------------------------------------------------------
    -- 3) PIEZA J
    -------------------------------------------------------------------------
        3 => (
            "1000111000000000", -- 0
            "0110001000100000", -- 1
            "0000111000100000", -- 2
            "0010001001100000"  -- 3
        ),

    -------------------------------------------------------------------------
    -- 4) PIEZA L
    -------------------------------------------------------------------------
        4 => (
            "0010111000000000", -- 0
            "0100010001100000", -- 1
            "0000111010000000", -- 2
            "0110001000100000"  -- 3
        ),

    -------------------------------------------------------------------------
    -- 5) PIEZA S
    -------------------------------------------------------------------------
        5 => (
            "0110110000000000", -- 0
            "0100011000100000", -- 1
            "0110110000000000", -- 2
            "0100011000100000"  -- 3
        ),

    -------------------------------------------------------------------------
    -- 6) PIEZA Z
    -------------------------------------------------------------------------
        6 => (
            "1100011000000000", -- 0
            "0010011001000000", -- 1
            "1100011000000000", -- 2
            "0010011001000000"  -- 3
        )
    );

begin
    -- Selección combinacional
    shape_16b <= TETROMINOS(piece_id)(rotation);

end architecture DATAFLOW;